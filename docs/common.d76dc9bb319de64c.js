"use strict";(self.webpackChunkcountries=self.webpackChunkcountries||[]).push([[592],{9882:(c,u,n)=>{n.d(u,{K:()=>f});var r=n(5619),g=n(2572),l=n(9397),a=n(7398),h=n(4946),_=n(9862);let f=(()=>{class o{constructor(e){this.http=e,this._changeRegion=new r.X(null),this._changeOptions=new r.X({showName:!1,showRegion:!1,showSubregion:!1}),this._countries=new r.X(null),this._regions=new r.X(null),this._searchCriteria=new r.X(null),this._subregions=new r.X(null),this.countries$=this.getCountriesByFilter(),this.options$=this._changeOptions.asObservable(),this.regions$=this._regions.asObservable(),this.subregions$=this.getSubregions(),this.getCountries().subscribe()}getCountries(){return this.http.get("https://restcountries.com/v3.1/all?fields=area,capital,cca2,coatOfArms,continents,currencies,flags,languages,latlng,name,population,region,subregion,timezones,tld").pipe((0,l.b)(e=>{const s=[],t=[];e.forEach(i=>{i.region&&!s.includes(i.region)&&s.push(i.region),i.subregion&&!t.some(b=>i.subregion===b.name)&&t.push({name:i.subregion,region:i.region})}),this._countries.next(this.shuffleCountries(e)),this._regions.next(s.sort()),this._subregions.next(t.sort(this.sortSubregions))}))}getCountriesByFilter(){return(0,g.a)([this._countries.asObservable(),this._searchCriteria.asObservable()]).pipe((0,a.U)(([e,s])=>e&&s?e.filter(t=>s.name?t.name.common.toLowerCase().includes(s.name.toLowerCase()):t).filter(t=>s.region?s.region===t.region:t).filter(t=>s.subregion?s.subregion===t.subregion:t):e))}getSubregions(){return(0,g.a)([this._subregions.asObservable(),this._changeRegion.asObservable()]).pipe((0,a.U)(([e,s])=>e&&s?e.filter(t=>t.region===s):e))}shuffleCountries(e){for(let s=e.length-1;s>0;s--){const t=Math.floor(Math.random()*(s+1));[e[s],e[t]]=[e[t],e[s]]}return e}sortSubregions(e,s){return e.name<s.name?-1:e.name>s.name?1:0}changeOptions(e){this._changeOptions.next(e)}changeRegion(e){this._changeRegion.next(e)}getCountry(e){return this.countries$.pipe((0,a.U)(s=>s?s.find(t=>t.cca2===e):void 0))}getCurrentOptions(){return this._changeOptions.getValue()}getCurrentSearchCriteria(){return this._searchCriteria.getValue()}search(e){this._searchCriteria.next(e)}static#e=this.\u0275fac=function(s){return new(s||o)(h.LFG(_.eN))};static#s=this.\u0275prov=h.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})()}}]);